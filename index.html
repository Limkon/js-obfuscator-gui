<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS ä¸“ä¸šä»£ç æ··æ·†å™¨ Pro</title>
    <style>
        :root { --primary: #8ccf98; --primary-dark: #6eb57a; --bg: #ffffff; --border: #e1e4e8; --text: #555; --text-active: #4a8a56; }
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background-color: #f9f9f9; color: var(--text); user-select: none; margin: 0; padding-bottom: 50px; }
        
        /* é¡¶éƒ¨ Tab å®¹å™¨ */
        .tab-container { background: white; border: 1px solid var(--border); border-radius: 4px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .tab-header { display: flex; border-bottom: 1px solid var(--border); background: #fcfcfc; }
        .tab-item { flex: 1; text-align: center; padding: 15px 0; cursor: pointer; color: #888; border-right: 1px solid var(--border); font-size: 14px; transition: 0.2s; }
        .tab-item:last-child { border-right: none; }
        .tab-item:hover { background: #fdfdfd; color: var(--text-active); }
        .tab-item.active { background: white; color: var(--text-active); font-weight: bold; border-top: 3px solid var(--primary-dark); border-bottom: 1px solid white; margin-bottom: -1px; }

        .tab-content { padding: 0; display: none; height: 300px; position: relative; }
        .tab-content.active { display: block; }

        textarea.code-area { width: 100%; height: 100%; border: none; padding: 15px; box-sizing: border-box; resize: none; font-family: 'Consolas', monospace; font-size: 13px; color: #333; outline: none; line-height: 1.5; }
        textarea.code-area:focus { background: #fafafa; }

        /* --- æ‚¬æµ®æŒ‰é’®æ ·å¼ --- */
        .overlay-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            padding: 5px 12px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            color: #555;
            transition: 0.2s;
            z-index: 10;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .overlay-btn:hover { background: #f0f0f0; color: #333; border-color: #bbb; }
        .overlay-btn:active { background: #e0e0e0; transform: translateY(1px); }

        .file-mode-container { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: #999; }
        .file-display { margin-top: 15px; font-weight: bold; color: #333; display: none; word-break: break-all; padding: 0 20px; text-align: center;}
        #btn-select-file { padding: 10px 25px; background: white; border: 1px solid var(--border); border-radius: 4px; cursor: pointer; transition: 0.2s; }
        #btn-select-file:hover { border-color: var(--primary); color: var(--primary-dark); }

        .action-bar { padding: 10px 15px; border-top: 1px solid var(--border); background: white; display: flex; align-items: center; }
        #btn-run { background: #a2dcae; color: white; border: none; padding: 8px 25px; border-radius: 4px; font-size: 14px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        #btn-run:hover { background: var(--primary-dark); }
        #btn-run:disabled { background: #ddd; cursor: not-allowed; }
        #status-msg { margin-left: 15px; font-size: 13px; color: #666; font-weight: bold; }

        /* --- æ–°å¢ï¼šä½“ç§¯ç»Ÿè®¡æ ·å¼ --- */
        #size-stats { margin-left: auto; font-size: 12px; color: #888; font-family: 'Segoe UI', sans-serif; background: #f5f5f5; padding: 4px 10px; border-radius: 4px; border: 1px solid #eee; display: none; }
        #size-stats span.highlight { color: #333; font-weight: bold; }
        #size-stats span.diff-up { color: #d9534f; }
        #size-stats span.diff-down { color: #5cb85c; }

        /* é…ç½®åŒº */
        .config-title { font-size: 18px; color: #333; margin: 30px 0 15px 0; border-left: 4px solid var(--primary); padding-left: 10px; }
        .config-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 15px; transition: 0.3s; }
        
        .panel { background: white; padding: 15px; border-radius: 4px; border: 1px solid var(--border); }
        h3 { margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 8px; font-size: 14px; color: #333; margin-bottom: 12px; }
        
        .form-item { margin-bottom: 8px; display: flex; align-items: center; font-size: 12px; color: #666; }
        .form-item label { margin-left: 6px; cursor: pointer; }
        .sub-item { margin-left: 22px; margin-bottom: 10px; }
        .input-full, select, textarea.config-text { width: 100%; padding: 4px; border: 1px solid #ddd; border-radius: 3px; font-size: 12px; box-sizing: border-box; }
        textarea.config-text { height: 40px; resize: vertical; font-family: monospace; }
        .help-text { color: #999; font-size: 11px; margin-bottom: 2px; }

        /* --- æ—¥å¿—æ§åˆ¶å°æ ·å¼ --- */
        #console-container { 
            margin-top: 10px; 
            border: 1px solid #333; 
            border-radius: 4px; 
            background: #1e1e1e; 
            color: #00ff00; 
            font-family: 'Consolas', monospace; 
            font-size: 12px; 
            padding: 10px; 
            height: 200px; 
            overflow-y: auto; 
            white-space: pre-wrap;
            user-select: text; 
            cursor: text;
        }
        
        .log-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        #btn-copy-log {
            padding: 4px 12px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            color: #555;
            transition: 0.2s;
        }
        #btn-copy-log:hover { background: #f0f0f0; border-color: #bbb; }
        #btn-copy-log:active { background: #e0e0e0; }

        .log-time { color: #888; margin-right: 10px; }
        .log-info { color: #4af; }
        .log-warn { color: #fa0; }
        .log-error { color: #f55; }

    </style>
</head>
<body>

    <div class="tab-container">
        <div class="tab-header">
            <div id="tab-item-paste" class="tab-item active" data-tab="tab-paste">ç²˜è´´JavaScriptä»£ç </div>
            <div id="tab-item-file" class="tab-item" data-tab="tab-file">é€‰æ‹©JavaScriptæ–‡ä»¶</div>
            <div id="tab-item-result" class="tab-item" data-tab="tab-result">åŠ å¯†ç»“æœ</div>
        </div>

        <div id="tab-paste" class="tab-content active">
            <textarea id="rawCodeInput" class="code-area" placeholder="// åœ¨æ­¤å¤„ç²˜è´´æ‚¨çš„ JavaScript æºä»£ç ..."></textarea>
            <button id="btn-clear-code" class="overlay-btn" title="æ¸…ç©ºä»£ç ">ğŸ—‘ï¸ æ¸…ç©º</button>
        </div>

        <div id="tab-file" class="tab-content">
            <div class="file-mode-container">
                <button id="btn-select-file">ç‚¹å‡»é€‰æ‹© JS æ–‡ä»¶</button>
                <div id="file-path-display" class="file-display"></div>
                <div style="margin-top:5px; font-size:12px; color:#aaa;">æ··æ·†åçš„æ–‡ä»¶å°†è‡ªåŠ¨ä¿å­˜åœ¨æºæ–‡ä»¶åŒç›®å½•ä¸‹</div>
            </div>
        </div>

        <div id="tab-result" class="tab-content">
            <textarea id="resultOutput" class="code-area" readonly placeholder="ç‚¹å‡»â€œæ··æ·†åŠ å¯†â€åï¼Œç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
            <button id="btn-copy-result" class="overlay-btn" title="å¤åˆ¶ç»“æœ">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
        </div>

        <div class="action-bar">
            <button id="btn-run">æ··æ·†åŠ å¯†</button>
            <span id="status-msg"></span>
            <span id="size-stats"></span>
        </div>
    </div>

    <div class="config-title">é«˜çº§å‚æ•°é…ç½®</div>
    <div class="config-grid" id="configPanel">
        <div class="panel">
            <h3>æ··æ·†é€‰é¡¹é¢„è®¾</h3>
            <div class="form-item"><input type="radio" name="preset" value="default" checked id="pre_default"><label for="pre_default">é»˜è®¤ (é«˜æ€§èƒ½)</label></div>
            <div class="form-item"><input type="radio" name="preset" value="minimal" id="pre_minimal"><label for="pre_minimal" style="color:#d9534f; font-weight:bold;">æç®€æ¨¡å¼ (ä½“ç§¯æœ€å°)</label></div>
            <div class="form-item"><input type="radio" name="preset" value="low" id="pre_low"><label for="pre_low">ä½æ··æ·† (é«˜æ€§èƒ½)</label></div>
            <div class="form-item"><input type="radio" name="preset" value="medium" id="pre_medium"><label for="pre_medium">ä¸­ç­‰æ··æ·† (å‡è¡¡)</label></div>
            <div class="form-item"><input type="radio" name="preset" value="high" id="pre_high"><label for="pre_high">é«˜æ··æ·† (ä½æ€§èƒ½)</label></div>
        </div>

        <div class="panel">
            <h3>è¿è¡Œç¯å¢ƒ (Target)</h3>
            <div class="form-item"><input type="radio" name="target" value="browser" checked id="target_browser"><label for="target_browser">Browser (æµè§ˆå™¨)</label></div>
            <div class="form-item"><input type="radio" name="target" value="browser-no-eval" id="target_browser_no_eval"><label for="target_browser_no_eval">Browser (æ—  Eval)</label></div>
            <div class="form-item"><input type="radio" name="target" value="node" id="target_node"><label for="target_node">Node.js (é€šç”¨)</label></div>
            <div class="form-item" style="color: #2c7c38; font-weight: bold;">
                <input type="radio" name="target" value="node-pure" id="target_node_pure">
                <label for="target_node_pure">Node.js (çº¯å‡€ - æ— Window)</label>
            </div>
        </div>

        <div class="panel">
            <h3>åŸºç¡€è®¾ç½®</h3>
            <div class="form-item" style="color: #2c7c38; font-weight: bold; border-bottom: 1px dashed #ddd; padding-bottom: 5px; margin-bottom: 8px;">
                <input type="checkbox" id="enableCustomAST">
                <label for="enableCustomAST">å¯ç”¨è‡ªå®šä¹‰ AST è§„åˆ™ (ç‹¬æœ‰æ··æ·†)</label>
            </div>
            
            <div class="form-item"><input type="checkbox" id="compact" checked><label for="compact">ç´§å‡‘ä»£ç  (Compact)</label></div>
            <div class="form-item"><input type="checkbox" id="selfDefending"><label for="selfDefending">è‡ªæˆ‘ä¿æŠ¤ (é˜²æ ¼å¼åŒ–)</label></div>
            <div class="form-item"><input type="checkbox" id="debugProtection"><label for="debugProtection">ç¦æ­¢æ§åˆ¶å°è°ƒè¯•</label></div>
            <div class="form-item"><input type="checkbox" id="disableConsoleOutput"><label for="disableConsoleOutput">ç¦æ­¢Consoleè¾“å‡º</label></div>
            <div class="form-item"><input type="checkbox" id="numbersToExpressions"><label for="numbersToExpressions">æ•°å€¼è½¬è¡¨è¾¾å¼</label></div>
            <div class="form-item"><input type="checkbox" id="simplify" checked><label for="simplify">ä¼˜åŒ–ä»£ç ç»“æ„</label></div>
            <div class="form-item"><input type="checkbox" id="splitStrings"><label for="splitStrings">åˆ†å‰²å­—ç¬¦ä¸²</label></div>
            <div class="form-item"><input type="checkbox" id="unicodeEscapeSequence"><label for="unicodeEscapeSequence">Unicode è½¬ä¹‰</label></div>
            <div class="form-item"><input type="checkbox" id="renameGlobals"><label for="renameGlobals">é‡å‘½åå…¨å±€å˜é‡</label></div>
        </div>

        <div class="panel">
            <h3>åŠ å¯†ç³»æ•°</h3>
            <div class="form-item"><input type="checkbox" id="deadCodeInjection"><label for="deadCodeInjection">æ³¨å…¥æ­»ä»£ç </label></div>
            <div class="sub-item">
                <input type="number" id="deadCodeInjectionThreshold" class="input-full" value="0.4" step="0.1" max="1" min="0">
            </div>
            
            <div class="form-item"><input type="checkbox" id="controlFlowFlattening"><label for="controlFlowFlattening">æ§åˆ¶æµå¹³å¦åŒ–</label></div>
            <div class="sub-item">
                <input type="number" id="controlFlowFlatteningThreshold" class="input-full" value="0.75" step="0.1" max="1" min="0">
            </div>

            <div class="sub-item" style="margin-left:0; margin-top:10px">
                <div class="help-text">æ ‡è¯†ç¬¦ç”Ÿæˆå™¨:</div>
                <select id="identifierNamesGenerator">
                    <option value="hexadecimal">hexadecimal (16è¿›åˆ¶)</option>
                    <option value="mangled">mangled (ç®€çŸ­å­—ç¬¦)</option>
                    <option value="mangled-shuffled">mangled-shuffled</option>
                    <option value="dictionary">dictionary (å­—å…¸)</option>
                </select>
            </div>
        </div>

        <div class="panel">
            <h3>é«˜çº§è®¾ç½®</h3>
            <div class="help-text">åŸŸåé”å®š (æ¯è¡Œä¸€ä¸ª):</div>
            <textarea id="domainLock" class="config-text" placeholder="example.com"></textarea>
            
            <div class="help-text">é‡å®šå‘ URL:</div>
            <input type="text" id="domainLockRedirectUrl" class="input-full" placeholder="about:blank">
            
            <div class="help-text" style="margin-top:5px">ä¿ç•™å­—ç¬¦ä¸² (æ¯è¡Œä¸€ä¸ª):</div>
            <textarea id="reservedStrings" class="config-text" placeholder="react&#10;vue"></textarea>
            
            <div class="help-text" style="margin-top:5px">ä¿ç•™å˜é‡å (æ¯è¡Œä¸€ä¸ª):</div>
            <textarea id="reservedNames" class="config-text" placeholder="jQuery&#10;$"></textarea>
        </div>
    </div>

    <div class="log-header">
        <div class="config-title" style="margin: 0; border: none; padding: 0; border-left: 4px solid var(--primary); padding-left: 10px;">è°ƒè¯•æ—¥å¿— (Debug Log)</div>
        <button id="btn-copy-log">ğŸ“„ å¤åˆ¶æ—¥å¿—</button>
    </div>
    <div id="console-container">ç­‰å¾…æ“ä½œ...</div>

    <script src="renderer.js"></script>
</body>
</html>
